function dGamma_dot_dq = dGamma_dot_dq_fun(in1,in2,in3,in4,alpha,in6,in7,b_C,in9,in10,in11)
%DGAMMA_DOT_DQ_FUN
%    DGAMMA_DOT_DQ = DGAMMA_DOT_DQ_FUN(IN1,IN2,IN3,IN4,ALPHA,IN6,IN7,B_C,IN9,IN10,IN11)

%    This function was generated by the Symbolic Math Toolbox version 8.6.
%    18-May-2021 12:46:34

A_p0 = in7(1,:);
A_p1 = in7(2,:);
A_p2 = in7(3,:);
A_p3 = in7(4,:);
A_p4 = in7(5,:);
A_p5 = in7(6,:);
d_Ca = in9(1,:);
d_Cb = in9(2,:);
gx = in10(1,:);
gy = in10(2,:);
k0 = in11(1,:);
k1 = in11(2,:);
k2 = in11(3,:);
l_p0 = in6(1,:);
l_p1 = in6(2,:);
l_p2 = in6(3,:);
l_p3 = in6(4,:);
l_p4 = in6(5,:);
l_p5 = in6(6,:);
mu_p0_t0 = in4(1,:);
mu_p1_t0 = in4(2,:);
mu_p2_t0 = in4(3,:);
mu_p3_t0 = in4(4,:);
mu_p4_t0 = in4(5,:);
mu_p5_t0 = in4(6,:);
q0 = in1(1,:);
q1 = in1(2,:);
q2 = in1(3,:);
q_ref0 = in3(1,:);
q_ref1 = in3(2,:);
q_ref2 = in3(3,:);
qdot0 = in2(1,:);
qdot1 = in2(2,:);
qdot2 = in2(3,:);
dGamma_dot_dq = reshape([-(qdot0.*((1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(-gx.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q0.^2.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.*q1.^2.*cos(alpha+q0+q1).*6.0+gy.*q0.*q2.^2.*cos(alpha+q0+q1).*6.0+gx.*q0.*q1.^2.*sin(alpha+q0+q1).*6.0-gx.*q0.*q2.^2.*sin(alpha+q0+q1).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*6.0-gx.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*6.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*6.0+gy.*q0.*q1.^2.*cos(alpha+q0+q1+q2).*6.0-gx.*q0.*q1.^2.*sin(alpha+q0+q1+q2).*6.0-gy.*q0.*q2.^2.*cos(alpha+q0).*6.0+gx.*q0.*q2.^2.*sin(alpha+q0).*6.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*6.0+gx.*q0.^2.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.*q2.^2.*cos(alpha+q0).*1.2e+1+gy.*q0.*q1.*q2.^2.*sin(alpha+q0).*1.2e+1-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*7.0+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*1.2e+1+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*7.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*1.2e+1-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.*q1.*q2.^2.*cos(alpha+q0+q1).*6.0+gx.*q0.*q1.^2.*q2.*cos(alpha+q0+q1).*6.0-gy.*q0.*q1.*q2.^2.*sin(alpha+q0+q1).*6.0+gy.*q0.*q1.^2.*q2.*sin(alpha+q0+q1).*6.0+gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*6.0+gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*6.0-gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0).*3.0+1.0./q0.^5.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*6.0))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).^2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p0+(qdot1.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0).*6.0-gx.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*cos(alpha+q0+q1).*6.0-gx.*q0.^2.*q1.*sin(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*6.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gy.*q0.^2.*q1.*cos(alpha+q0+q1+q2).*6.0+gx.*q0.^2.*q1.*sin(alpha+q0+q1+q2).*6.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0+gy.*q1.*q2.^2.*cos(alpha+q0).*6.0-gx.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q1.*q2.^2.*cos(alpha).*6.0+gx.*q1.*q2.^2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q2.^2.*cos(alpha+q0).*6.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.*q1.*q2.^2.*sin(alpha+q0).*6.0+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p0.*b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(qdot2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.*cos(alpha+q0+q1).*2.0-gy.*q0.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q0.^2.*q2.*sin(alpha+q0+q1).*6.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^3.*q2.*cos(alpha+q0).*2.0+gy.*q0.^2.*q2.*cos(alpha+q0).*6.0+gy.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q2.*sin(alpha+q0).*6.0-gx.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^3.*q2.*sin(alpha+q0).*2.0-gy.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q0.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*1.2e+1-gy.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*1.2e+1+gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0).*(3.0./2.0)+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p0.*b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./b_C.^2.*qdot2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p0+(1.0./b_C.^2.*qdot1.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p0,(qdot0.*((1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(-gx.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q0.^2.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.*q1.^2.*cos(alpha+q0+q1).*6.0+gy.*q0.*q2.^2.*cos(alpha+q0+q1).*6.0+gx.*q0.*q1.^2.*sin(alpha+q0+q1).*6.0-gx.*q0.*q2.^2.*sin(alpha+q0+q1).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*6.0-gx.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*6.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*6.0+gy.*q0.*q1.^2.*cos(alpha+q0+q1+q2).*6.0-gx.*q0.*q1.^2.*sin(alpha+q0+q1+q2).*6.0-gy.*q0.*q2.^2.*cos(alpha+q0).*6.0+gx.*q0.*q2.^2.*sin(alpha+q0).*6.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*6.0+gx.*q0.^2.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.*q2.^2.*cos(alpha+q0).*1.2e+1+gy.*q0.*q1.*q2.^2.*sin(alpha+q0).*1.2e+1-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*7.0+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*1.2e+1+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*7.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*1.2e+1-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.*q1.*q2.^2.*cos(alpha+q0+q1).*6.0+gx.*q0.*q1.^2.*q2.*cos(alpha+q0+q1).*6.0-gy.*q0.*q1.*q2.^2.*sin(alpha+q0+q1).*6.0+gy.*q0.*q1.^2.*q2.*sin(alpha+q0+q1).*6.0+gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*6.0+gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*6.0-gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0).*3.0+1.0./q0.^5.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*6.0))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).^2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p1-(qdot1.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0).*6.0-gx.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*cos(alpha+q0+q1).*6.0-gx.*q0.^2.*q1.*sin(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*6.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gy.*q0.^2.*q1.*cos(alpha+q0+q1+q2).*6.0+gx.*q0.^2.*q1.*sin(alpha+q0+q1+q2).*6.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0+gy.*q1.*q2.^2.*cos(alpha+q0).*6.0-gx.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q1.*q2.^2.*cos(alpha).*6.0+gx.*q1.*q2.^2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q2.^2.*cos(alpha+q0).*6.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.*q1.*q2.^2.*sin(alpha+q0).*6.0+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p1.*b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(qdot2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.*cos(alpha+q0+q1).*2.0-gy.*q0.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q0.^2.*q2.*sin(alpha+q0+q1).*6.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^3.*q2.*cos(alpha+q0).*2.0+gy.*q0.^2.*q2.*cos(alpha+q0).*6.0+gy.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q2.*sin(alpha+q0).*6.0-gx.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^3.*q2.*sin(alpha+q0).*2.0-gy.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q0.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*1.2e+1-gy.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*1.2e+1+gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0).*(3.0./2.0)+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p1.*b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./b_C.^2.*qdot2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p1+(1.0./b_C.^2.*qdot1.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p1,(qdot1.*((1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0-1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0)))./A_p2+(qdot2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q1.*q2.*sin(alpha+q0).*4.0))./2.0-1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0)))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0).*2.0)+(1.0./b_C.^2.*1.0./q1.^6.*1.0./q2.^4.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0).^2)./(A_p2.*2.0)+(1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*qdot2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./A_p2,-(qdot1.*((1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0-1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0)))./A_p3-(qdot2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q1.*q2.*sin(alpha+q0).*4.0))./2.0-1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0)))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0).*2.0)+(1.0./b_C.^2.*1.0./q1.^6.*1.0./q2.^4.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0).^2)./(A_p3.*2.0)+(1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*qdot2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./A_p3,-(qdot2.*((1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0))./A_p4+(1.0./b_C.^2.*qdot0.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p4+(1.0./b_C.^2.*qdot1.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p4+(qdot0.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p4.*b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(qdot1.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p4.*b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0)),(qdot2.*((1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0))./A_p5+(1.0./b_C.^2.*qdot0.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p5+(1.0./b_C.^2.*qdot1.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p5-(qdot0.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p5.*b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(qdot1.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p5.*b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0)),(qdot0.*((1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0).*6.0-gx.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*cos(alpha+q0+q1).*6.0-gx.*q0.^2.*q1.*sin(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*6.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gy.*q0.^2.*q1.*cos(alpha+q0+q1+q2).*6.0+gx.*q0.^2.*q1.*sin(alpha+q0+q1+q2).*6.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0+gy.*q1.*q2.^2.*cos(alpha+q0).*6.0-gx.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q1.*q2.^2.*cos(alpha).*6.0+gx.*q1.*q2.^2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q2.^2.*cos(alpha+q0).*6.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.*q1.*q2.^2.*sin(alpha+q0).*6.0+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p0+(1.0./b_C.^2.*qdot1.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p0-(qdot1.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*-2.0+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*sin(alpha+q0+q1+q2).*2.0-gx.*q2.^2.*cos(alpha+q0).*4.0-gy.*q2.^2.*sin(alpha+q0).*4.0+gx.*q2.^2.*cos(alpha).*4.0+gy.*q2.^2.*sin(alpha).*4.0-gy.*q0.^3.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1).*4.0+gx.*q0.^3.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1).*4.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*3.0-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*4.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*4.0-gy.*q0.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q2.^2.*sin(alpha).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^2.*q2.^2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*4.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*4.0+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+1.0./q0.^3.*1.0./q1.^4.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p0.*b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(qdot2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0)-1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q1.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*cos(alpha+q0+q1).*4.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*4.0+gx.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q1.*q2.*sin(alpha+q0).*8.0-gx.*q1.*q2.*cos(alpha).*8.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q1.*q2.*sin(alpha).*8.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q2.*cos(alpha+q0).*4.0-gy.*q0.^3.*q2.*sin(alpha+q0).*4.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*8.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.*q1.*q2.*cos(alpha+q0).*4.0-gx.*q0.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.*q2.*cos(alpha).*1.2e+1+gx.*q0.*q1.*q2.*sin(alpha).*1.2e+1))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*2.0))./(A_p0.*b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./b_C.^2.*qdot2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p0,-(qdot0.*((1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0).*6.0-gx.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*cos(alpha+q0+q1).*6.0-gx.*q0.^2.*q1.*sin(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*6.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gy.*q0.^2.*q1.*cos(alpha+q0+q1+q2).*6.0+gx.*q0.^2.*q1.*sin(alpha+q0+q1+q2).*6.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0+gy.*q1.*q2.^2.*cos(alpha+q0).*6.0-gx.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q1.*q2.^2.*cos(alpha).*6.0+gx.*q1.*q2.^2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q2.^2.*cos(alpha+q0).*6.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.*q1.*q2.^2.*sin(alpha+q0).*6.0+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0-gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gy.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p1+(1.0./b_C.^2.*qdot1.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p1+(qdot1.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*-2.0+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*sin(alpha+q0+q1+q2).*2.0-gx.*q2.^2.*cos(alpha+q0).*4.0-gy.*q2.^2.*sin(alpha+q0).*4.0+gx.*q2.^2.*cos(alpha).*4.0+gy.*q2.^2.*sin(alpha).*4.0-gy.*q0.^3.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*sin(alpha+q0+q1).*2.0-gy.*q0.^2.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1).*4.0+gx.*q0.^3.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1).*4.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*3.0-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*4.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*4.0-gy.*q0.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q2.^2.*sin(alpha).*6.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^2.*q2.^2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*4.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*4.0+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+1.0./q0.^3.*1.0./q1.^4.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p1.*b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(qdot2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0)-1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q1.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*cos(alpha+q0+q1).*4.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*4.0+gx.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q1.*q2.*sin(alpha+q0).*8.0-gx.*q1.*q2.*cos(alpha).*8.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q1.*q2.*sin(alpha).*8.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q2.*cos(alpha+q0).*4.0-gy.*q0.^3.*q2.*sin(alpha+q0).*4.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*8.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.*q1.*q2.*cos(alpha+q0).*4.0-gx.*q0.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.*q2.*cos(alpha).*1.2e+1+gx.*q0.*q1.*q2.*sin(alpha).*1.2e+1))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*2.0))./(A_p1.*b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./b_C.^2.*qdot2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p1,-(qdot1.*((1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*-6.0-gy.*q1.^3.*cos(alpha+q0+q1+q2)+gx.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q1.^2.*sin(alpha+q0+q1+q2).*6.0-gy.*q1.*cos(alpha+q0+q1).*6.0+gx.*q1.*sin(alpha+q0+q1).*6.0+gx.*q1.^2.*cos(alpha+q0+q1).*6.0+gy.*q1.^3.*cos(alpha+q0+q1)-gx.*q1.^3.*sin(alpha+q0+q1)+gy.*q1.^2.*sin(alpha+q0+q1).*6.0+gy.*q1.*cos(alpha+q0+q1+q2).*6.0-gx.*q1.*sin(alpha+q0+q1+q2).*6.0-gx.*q1.^3.*q2.*cos(alpha+q0+q1)-gy.*q1.*q2.^2.*cos(alpha+q0+q1).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q1.*q2.^2.*sin(alpha+q0+q1).*4.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*6.0-gy.*q1.^3.*q2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.*cos(alpha+q0+q1).*6.0+gy.*q1.*q2.*sin(alpha+q0+q1).*6.0))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)).*3.0+1.0./q1.^5.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*6.0))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p2-(qdot2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0+q1).*4.0+gy.*q1.*q2.*sin(alpha+q0+q1).*4.0).*(-1.0./2.0)+1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1))+1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0).*(3.0./2.0)+1.0./q1.^4.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*3.0))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*qdot2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p2-(1.0./q1.^4.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0).*2.0)+(1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./A_p2,(qdot1.*((1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*-6.0-gy.*q1.^3.*cos(alpha+q0+q1+q2)+gx.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q1.^2.*sin(alpha+q0+q1+q2).*6.0-gy.*q1.*cos(alpha+q0+q1).*6.0+gx.*q1.*sin(alpha+q0+q1).*6.0+gx.*q1.^2.*cos(alpha+q0+q1).*6.0+gy.*q1.^3.*cos(alpha+q0+q1)-gx.*q1.^3.*sin(alpha+q0+q1)+gy.*q1.^2.*sin(alpha+q0+q1).*6.0+gy.*q1.*cos(alpha+q0+q1+q2).*6.0-gx.*q1.*sin(alpha+q0+q1+q2).*6.0-gx.*q1.^3.*q2.*cos(alpha+q0+q1)-gy.*q1.*q2.^2.*cos(alpha+q0+q1).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q1.*q2.^2.*sin(alpha+q0+q1).*4.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*6.0-gy.*q1.^3.*q2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.*cos(alpha+q0+q1).*6.0+gy.*q1.*q2.*sin(alpha+q0+q1).*6.0))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)).*3.0+1.0./q1.^5.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*6.0))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p3+(qdot2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0+q1).*4.0+gy.*q1.*q2.*sin(alpha+q0+q1).*4.0).*(-1.0./2.0)+1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1))+1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0).*(3.0./2.0)+1.0./q1.^4.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*3.0))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*qdot2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p3+(1.0./q1.^4.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gx.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0).*2.0)+(1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./A_p3,-(qdot2.*((1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0))./A_p4+(1.0./b_C.^2.*qdot0.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p4+(1.0./b_C.^2.*qdot1.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p4+(qdot0.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p4.*b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(qdot1.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p4.*b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0)),(qdot2.*((1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0))./A_p5+(1.0./b_C.^2.*qdot0.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p5+(1.0./b_C.^2.*qdot1.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).^2.*2.0)./A_p5-(qdot0.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p5.*b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(qdot1.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))))./(A_p5.*b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0)),(qdot0.*((1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.*cos(alpha+q0+q1).*2.0-gy.*q0.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q0.^2.*q2.*sin(alpha+q0+q1).*6.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^3.*q2.*cos(alpha+q0).*2.0+gy.*q0.^2.*q2.*cos(alpha+q0).*6.0+gy.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q2.*sin(alpha+q0).*6.0-gx.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^3.*q2.*sin(alpha+q0).*2.0-gy.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q0.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*1.2e+1-gy.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*1.2e+1+gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0).*(3.0./2.0)+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p0-(qdot2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0).*2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0).*4.0+gy.*q0.^3.*cos(alpha+q0).*2.0-gx.*q0.^3.*sin(alpha+q0).*2.0+gy.*q1.^2.*sin(alpha+q0).*4.0-gx.*q1.^2.*cos(alpha).*4.0-gy.*q1.^2.*sin(alpha).*4.0-gy.*q0.^3.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*sin(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*sin(alpha).*6.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^2.*q1.^2.*cos(alpha+q0).*4.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^4.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p0.*b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*qdot2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p0-(qdot1.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0)-1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q1.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*cos(alpha+q0+q1).*4.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*4.0+gx.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q1.*q2.*sin(alpha+q0).*8.0-gx.*q1.*q2.*cos(alpha).*8.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q1.*q2.*sin(alpha).*8.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q2.*cos(alpha+q0).*4.0-gy.*q0.^3.*q2.*sin(alpha+q0).*4.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*8.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.*q1.*q2.*cos(alpha+q0).*4.0-gx.*q0.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.*q2.*cos(alpha).*1.2e+1+gx.*q0.*q1.*q2.*sin(alpha).*1.2e+1))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*2.0))./(A_p0.*b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./b_C.^2.*qdot1.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p0.*l_p0-b_C.*(d_Ca-d_Cb))+(k0.*q_ref0.*(-1.0./2.0)+(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p0.*b_C.*(d_Ca-d_Cb).^2.*(l_p0-mu_p0_t0).*5.0e+4)./(A_p0.*mu_p0_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p0.*l_p0.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p0,-(qdot0.*((1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.*cos(alpha+q0+q1).*2.0-gy.*q0.^2.*q2.*cos(alpha+q0+q1).*6.0+gx.*q0.^2.*q2.*sin(alpha+q0+q1).*6.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^3.*q2.*cos(alpha+q0).*2.0+gy.*q0.^2.*q2.*cos(alpha+q0).*6.0+gy.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q2.*sin(alpha+q0).*6.0-gx.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^3.*q2.*sin(alpha+q0).*2.0-gy.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gx.*q0.*q1.^2.*q2.*cos(alpha+q0).*6.0-gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*1.2e+1-gy.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*1.2e+1+gy.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0-gx.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^2.*q1.*q2.*cos(alpha+q0+q1).*6.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0+q1).*6.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0).*(3.0./2.0)+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0)-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^2.*q2.^2.*sin(alpha+q0).*3.0+gx.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^3.*q2.^2.*sin(alpha+q0)+gy.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q1.^2.*q2.^2.*sin(alpha).*3.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1)-gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q0.^2.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q0.^2.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^2.*q1.^2.*cos(alpha+q0+q1+q2).*3.0-gx.*q0.^2.*q1.^2.*sin(alpha+q0+q1+q2).*3.0-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0)-gy.*q0.^2.*q2.^2.*cos(alpha+q0).*3.0-gy.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0-gx.*q0.*q1.^2.*q2.^2.*cos(alpha+q0).*3.0+gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*6.0+gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*sin(alpha+q0).*3.0+gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*6.0-gy.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0+q1).*3.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0+q1).*3.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0))./2.0-1.0./q0.^4.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*(3.0./2.0)).*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p1+(qdot2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0).*2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0).*4.0+gy.*q0.^3.*cos(alpha+q0).*2.0-gx.*q0.^3.*sin(alpha+q0).*2.0+gy.*q1.^2.*sin(alpha+q0).*4.0-gx.*q1.^2.*cos(alpha).*4.0-gy.*q1.^2.*sin(alpha).*4.0-gy.*q0.^3.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*sin(alpha+q0+q1).*2.0+gy.*q0.^2.*q1.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*sin(alpha).*6.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^2.*q1.^2.*cos(alpha+q0).*4.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^4.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*3.0))./(A_p1.*b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*qdot2.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p1+(qdot1.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0)-1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q1.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*cos(alpha+q0+q1).*4.0-gy.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q2.*sin(alpha+q0+q1).*4.0+gx.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q1.*q2.*sin(alpha+q0).*8.0-gx.*q1.*q2.*cos(alpha).*8.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q1.*q2.*sin(alpha).*8.0+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0+gy.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q2.*cos(alpha+q0).*4.0-gy.*q0.^3.*q2.*sin(alpha+q0).*4.0+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^2.*q1.*q2.*cos(alpha+q0).*8.0+gy.*q0.^2.*q1.*q2.*sin(alpha+q0).*8.0+gy.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0+gy.*q0.*q1.*q2.*cos(alpha+q0).*4.0-gx.*q0.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.*q2.*cos(alpha).*1.2e+1+gx.*q0.*q1.*q2.*sin(alpha).*1.2e+1))./2.0+1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)).*2.0))./(A_p1.*b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./b_C.^2.*qdot1.*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.*cos(alpha+q0+q1).*-2.0+gx.*q0.^3.*q2.*sin(alpha+q0+q1).*2.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)+gx.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^3.*q2.*cos(alpha+q0).*2.0-gx.*q0.^3.*q2.*sin(alpha+q0).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0).*4.0-gx.*q1.^2.*q2.*cos(alpha).*4.0-gy.*q1.^2.*q2.*sin(alpha).*4.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q0.^3.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q0.*q1.^2.*q2.*cos(alpha+q0).*2.0-gx.*q0.*q1.^2.*q2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*q2.*sin(alpha+q0).*4.0-gy.*q0.*q1.^2.*q2.*cos(alpha).*6.0+gx.*q0.*q1.^2.*q2.*sin(alpha).*6.0+gx.*q0.^2.*q1.^2.*q2.*cos(alpha+q0).*4.0+gy.*q0.^2.*q1.^2.*q2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0))./2.0+1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^3.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*((1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gy.*q0.^3.*q2.^2.*sin(alpha+q0).*2.0-gy.*q0.^3.*q1.*cos(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.*sin(alpha+q0+q1).*2.0+gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gy.*q0.^3.*q2.^2.*sin(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*cos(alpha+q0+q1+q2).*2.0-gx.*q0.^3.*q1.*sin(alpha+q0+q1+q2).*2.0-gx.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q1.*q2.^2.*cos(alpha).*4.0+gy.*q1.*q2.^2.*sin(alpha).*4.0-gx.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gy.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)+gx.*q0.^3.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.*q2.^2.*cos(alpha+q0).*2.0+gx.*q0.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.*q2.^2.*cos(alpha).*6.0-gx.*q0.*q1.*q2.^2.*sin(alpha).*6.0-gx.*q0.^2.*q1.*q2.^2.*cos(alpha+q0).*4.0-gy.*q0.^2.*q1.*q2.^2.*sin(alpha+q0).*4.0+gx.*q0.^3.*q1.*q2.*cos(alpha+q0+q1).*2.0+gy.*q0.^3.*q1.*q2.*sin(alpha+q0+q1).*2.0-gy.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0-1.0./q0.^3.*1.0./q1.^3.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1))).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(1.0./(A_p1.*l_p1-b_C.*(d_Ca-d_Cb))+((k0.*q_ref0)./2.0-(1.0./q0.^3.*1.0./q1.^2.*1.0./q2.^2.*(gx.*q0.^3.*q2.^2.*sin(alpha+q0)-gy.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0+gx.*q1.^2.*q2.^2.*cos(alpha).*2.0+gy.*q1.^2.*q2.^2.*sin(alpha).*2.0-gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1)+gy.*q0.^3.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1)-gx.*q0.^3.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*cos(alpha+q0+q1+q2)-gx.*q0.^3.*q1.^2.*sin(alpha+q0+q1+q2)-gx.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^3.*q2.^2.*cos(alpha+q0)+gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.*q1.^2.*q2.^2.*cos(alpha+q0)+gx.*q0.*q1.^2.*q2.^2.*sin(alpha+q0)+gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0).*2.0+gy.*q0.*q1.^2.*q2.^2.*cos(alpha).*3.0-gx.*q0.*q1.^2.*q2.^2.*sin(alpha).*3.0-gx.*q0.^2.*q1.^2.*q2.^2.*cos(alpha+q0).*2.0-gy.*q0.^2.*q1.^2.*q2.^2.*sin(alpha+q0).*2.0-gx.*q0.^3.*q1.*q2.^2.*cos(alpha+q0+q1)+gx.*q0.^3.*q1.^2.*q2.*cos(alpha+q0+q1)-gy.*q0.^3.*q1.*q2.^2.*sin(alpha+q0+q1)+gy.*q0.^3.*q1.^2.*q2.*sin(alpha+q0+q1)))./2.0+(A_p1.*b_C.*(d_Ca-d_Cb).^2.*(l_p1-mu_p1_t0).*5.0e+4)./(A_p1.*mu_p1_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p1.*l_p1.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p1,-(qdot1.*((1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0+q1).*4.0+gy.*q1.*q2.*sin(alpha+q0+q1).*4.0).*(-1.0./2.0)+1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1))+1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0).*(3.0./2.0)+1.0./q1.^4.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p2+(1.0./b_C.^2.*qdot2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p2-(qdot2.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0).*2.0+1.0./q1.^3.*1.0./q2.^4.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*3.0-(1.0./q1.^3.*1.0./q2.^2.*(gx.*cos(alpha+q0).*-4.0-gy.*sin(alpha+q0).*4.0+gx.*cos(alpha+q0+q1).*4.0+gy.*sin(alpha+q0+q1).*4.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q1.^2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.*cos(alpha+q0).*4.0+gx.*q1.*sin(alpha+q0).*4.0))./2.0))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q1.*q2.*sin(alpha+q0).*4.0))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0).*2.0)-(1.0./q1.^3.*1.0./q2.^3.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./(A_p2.*b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p2.*l_p2-b_C.*(d_Ca-d_Cb))+(k1.*q_ref1.*(-1.0./2.0)+(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p2.*b_C.*(d_Ca-d_Cb).^2.*(l_p2-mu_p2_t0).*5.0e+4)./(A_p2.*mu_p2_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p2.*l_p2.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./A_p2,(qdot1.*((1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^2.*sin(alpha+q0+q1).*3.0-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0+q1).*4.0+gy.*q1.*q2.*sin(alpha+q0+q1).*4.0).*(-1.0./2.0)+1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1))+1.0./q1.^4.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0).*(3.0./2.0)+1.0./q1.^4.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*3.0))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)-gy.*q1.^2.*cos(alpha+q0+q1+q2).*3.0+gx.*q1.^2.*sin(alpha+q0+q1+q2).*3.0+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q1.^2.*cos(alpha+q0+q1).*3.0+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*sin(alpha+q0+q1).*3.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*cos(alpha+q0+q1).*3.0-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^2.*q2.*sin(alpha+q0+q1).*3.0+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)))./2.0+1.0./q1.^4.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*(3.0./2.0)).*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0))./A_p3+(1.0./b_C.^2.*qdot2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).^2.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*2.0)./A_p3+(qdot2.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(1.0./q1.^3.*1.0./q2.^3.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0).*2.0+1.0./q1.^3.*1.0./q2.^4.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0).*3.0-(1.0./q1.^3.*1.0./q2.^2.*(gx.*cos(alpha+q0).*-4.0-gy.*sin(alpha+q0).*4.0+gx.*cos(alpha+q0+q1).*4.0+gy.*sin(alpha+q0+q1).*4.0+gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q1.^2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.*cos(alpha+q0).*4.0+gx.*q1.*sin(alpha+q0).*4.0))./2.0))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gy.*q2.*cos(alpha+q0+q1).*4.0-gx.*q2.*sin(alpha+q0+q1).*4.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.*cos(alpha+q0).*4.0+gx.*q2.*sin(alpha+q0).*4.0+gy.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0-gx.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0+gx.*q1.*q2.*cos(alpha+q0).*4.0+gy.*q1.*q2.*sin(alpha+q0).*4.0))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0).*2.0)+(1.0./q1.^3.*1.0./q2.^3.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./(A_p3.*b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*1.0./q1.^3.*1.0./q2.^2.*qdot0.*1.0./(1.0./(A_p3.*l_p3-b_C.*(d_Ca-d_Cb))+((k1.*q_ref1)./2.0-(1.0./q1.^3.*1.0./q2.^2.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0))./2.0+(A_p3.*b_C.*(d_Ca-d_Cb).^2.*(l_p3-mu_p3_t0).*5.0e+4)./(A_p3.*mu_p3_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*((1.0./q1.^3.*1.0./q2.^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.*cos(alpha+q0+q1).*4.0+gy.*q2.*sin(alpha+q0+q1).*4.0-gx.*q1.^3.*cos(alpha+q0+q1)-gy.*q1.^3.*sin(alpha+q0+q1)-gx.*q2.*cos(alpha+q0).*4.0-gy.*q2.*sin(alpha+q0).*4.0+gx.*q1.^2.*q2.*cos(alpha+q0+q1).*2.0+gy.*q1.^2.*q2.*sin(alpha+q0+q1).*2.0-gy.*q1.*q2.*cos(alpha+q0).*4.0+gx.*q1.*q2.*sin(alpha+q0).*4.0))./2.0+1.0./q1.^3.*1.0./q2.^3.*(gy.*q1.^3.*cos(alpha+q0+q1+q2)-gx.*q1.^3.*sin(alpha+q0+q1+q2)+gx.*q2.^2.*cos(alpha+q0).*2.0+gy.*q2.^2.*sin(alpha+q0).*2.0-gx.*q2.^2.*cos(alpha+q0+q1).*2.0-gy.*q1.^3.*cos(alpha+q0+q1)+gx.*q1.^3.*sin(alpha+q0+q1)-gy.*q2.^2.*sin(alpha+q0+q1).*2.0+gx.*q1.^3.*q2.*cos(alpha+q0+q1)+gy.*q1.^3.*q2.*sin(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gy.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gy.*q1.*q2.^2.*cos(alpha+q0).*2.0-gx.*q1.*q2.^2.*sin(alpha+q0).*2.0)).*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p3.*l_p3.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*(gx.*q1.^3.*cos(alpha+q0+q1+q2)+gy.*q1.^3.*sin(alpha+q0+q1+q2)-gy.*q2.^2.*cos(alpha+q0).*2.0+gx.*q2.^2.*sin(alpha+q0).*2.0-gx.*q1.^3.*cos(alpha+q0+q1)+gy.*q2.^2.*cos(alpha+q0+q1).*2.0-gx.*q2.^2.*sin(alpha+q0+q1).*2.0-gy.*q1.^3.*sin(alpha+q0+q1)-gy.*q1.^3.*q2.*cos(alpha+q0+q1)+gx.*q1.^3.*q2.*sin(alpha+q0+q1)+gy.*q1.^2.*q2.^2.*cos(alpha+q0+q1)-gx.*q1.^2.*q2.^2.*sin(alpha+q0+q1)+gx.*q1.*q2.^2.*cos(alpha+q0).*2.0+gy.*q1.*q2.^2.*sin(alpha+q0).*2.0))./A_p3,-(qdot2.*((1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*3.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^4.*cos(alpha+q0+q1+q2).*9.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-gx.*1.0./q2.^4.*sin(alpha+q0+q1+q2).*9.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*3.0+gy.*1.0./q2.^4.*cos(alpha+q0+q1).*3.0-gx.*1.0./q2.^4.*sin(alpha+q0+q1).*3.0+gx.*1.0./q2.^5.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*1.2e+1+gy.*1.0./q2.^5.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*1.2e+1))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-1.0./b_C.^2.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).^2.*2.0))./A_p4-(qdot0.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(A_p4.*b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))-(qdot1.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(A_p4.*b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*qdot0.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0)./A_p4+(1.0./b_C.^2.*qdot1.*1.0./(1.0./(A_p4.*l_p4-b_C.*(d_Ca-d_Cb))+(k2.*q_ref2.*(-1.0./2.0)+(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0-(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0+gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p4.*b_C.*(d_Ca-d_Cb).^2.*(l_p4-mu_p4_t0).*5.0e+4)./(A_p4.*mu_p4_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p4.*l_p4.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0)./A_p4,(qdot2.*((1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*3.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^4.*cos(alpha+q0+q1+q2).*9.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-gx.*1.0./q2.^4.*sin(alpha+q0+q1+q2).*9.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*3.0+gy.*1.0./q2.^4.*cos(alpha+q0+q1).*3.0-gx.*1.0./q2.^4.*sin(alpha+q0+q1).*3.0+gx.*1.0./q2.^5.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*1.2e+1+gy.*1.0./q2.^5.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*1.2e+1))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+1.0./b_C.^2.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).^2.*2.0))./A_p5+(qdot0.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(A_p5.*b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(qdot1.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^2.*(gx.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+gx.*1.0./q2.^3.*cos(alpha+q0+q1)+gy.*1.0./q2.^3.*sin(alpha+q0+q1)-gy.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gx.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0))./(A_p5.*b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))+(1.0./b_C.^2.*qdot0.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0)./A_p5+(1.0./b_C.^2.*qdot1.*1.0./(1.0./(A_p5.*l_p5-b_C.*(d_Ca-d_Cb))+((k2.*q_ref2)./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0-(gy.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gx.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gx.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))-gy.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))+(A_p5.*b_C.*(d_Ca-d_Cb).^2.*(l_p5-mu_p5_t0).*5.0e+4)./(A_p5.*mu_p5_t0-b_C.*d_Ca+b_C.*d_Cb))./(b_C.*(d_Ca-d_Cb).*(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).*(d_Ca./2.0-d_Cb./2.0))).^3.*1.0./(d_Ca-d_Cb).^2.*1.0./(A_p5.*l_p5.*1.0e+5-b_C.*(d_Ca-d_Cb).*1.0e+5).^2.*1.0./(d_Ca./2.0-d_Cb./2.0).^2.*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+(gx.*1.0./q2.^2.*cos(alpha+q0+q1))./2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1))./2.0-gy.*1.0./q2.^3.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2))+gx.*1.0./q2.^3.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2))).*((gx.*1.0./q2.^2.*cos(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1+q2).*2.0-gx.*1.0./q2.^3.*sin(alpha+q0+q1+q2).*2.0+(gy.*1.0./q2.^2.*sin(alpha+q0+q1+q2))./2.0+gy.*1.0./q2.^3.*cos(alpha+q0+q1)-gx.*1.0./q2.^3.*sin(alpha+q0+q1)+gx.*1.0./q2.^4.*(cos(alpha+q0+q1)-cos(alpha+q0+q1+q2)).*3.0+gy.*1.0./q2.^4.*(sin(alpha+q0+q1)-sin(alpha+q0+q1+q2)).*3.0).*2.0)./A_p5],[6,3]);
